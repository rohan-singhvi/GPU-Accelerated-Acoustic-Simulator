services:
  cuda-dev:
    build:
      context: .
      args:
        INSTALL_GPU: "false"

    container_name: acoustic-sim-dev
    
    volumes:
      # mount the code (syncs changes live)
      - .:/app
      # preserve the .venv folder (The Volume Trick)
      # this tells Docker: "Don't overwrite /app/.venv with the host folder.
      # keep the version we built inside the container."
      - /app/.venv
      
      # ssh keys (kept from your original)
      - ~/.ssh:/root/.ssh:ro
      
    environment:
      - NUMBA_ENABLE_CUDASIM=1
      # ensure python doesn't buffer output (better for logs)
      - PYTHONUNBUFFERED=1
      
    tty: true
    stdin_open: true
